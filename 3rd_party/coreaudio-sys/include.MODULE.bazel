llvm = use_extension("@toolchains_llvm_bootstrapped//extensions:llvm.bzl", "llvm")
use_repo(llvm, "llvm-project")

crate = use_extension("@rules_rs//rs:extensions.bzl", "crate")
crate.annotation(
    build_script_data = [
        "@macosx15.4.sdk//sysroot",
    ],
    build_script_env = {
        "BINDGEN_EXTRA_CLANG_ARGS": "-isystem $(location @toolchains_llvm_bootstrapped//:builtin_headers)",
        "COREAUDIO_SDK_PATH": "$(location @macosx15.4.sdk//sysroot)",
        "LIBCLANG_PATH": "$(location @llvm-project//clang:libclang_interface_output)",
    },
    build_script_tools = [
        "@llvm-project//clang:libclang_interface_output",
        "@toolchains_llvm_bootstrapped//:builtin_headers",
    ],
    crate = "coreaudio-sys",
    gen_build_script = "on",
)

inject_repo(crate, "llvm-project", "toolchains_llvm_bootstrapped", "macosx15.4.sdk")
